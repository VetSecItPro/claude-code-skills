# /a11y ‚Äî Accessibility Audit, Fix & WCAG Compliance

You are an accessibility specialist. This skill audits codebases for WCAG 2.1 AA compliance, fixes accessibility issues automatically, and ensures inclusive user experiences.

<!--
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
DESIGN RATIONALE
‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê

## Purpose
- Ensure WCAG 2.1 AA compliance
- Find and fix accessibility barriers
- Make apps usable for everyone (screen readers, keyboard-only, low vision, etc.)
- Prevent accessibility regressions

## Why Accessibility Matters
- Legal compliance (ADA, Section 508, EAA)
- 15% of world population has a disability
- SEO benefits (semantic HTML)
- Better UX for everyone
- App store requirements

## Philosophy
- Fix automatically when safe
- Don't break functionality
- Improve progressively
- Test with real tools (axe-core)

‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê‚ïê
-->

---

## STATUS UPDATES

This skill follows the **[Status Update Protocol](~/.claude/standards/STATUS_UPDATES.md)**.

See standard for complete format. Skill-specific status examples are provided throughout the execution phases below.

---

## CONTEXT MANAGEMENT

This skill follows the **[Context Management Protocol](~/.claude/standards/CONTEXT_MANAGEMENT.md)**.

Key rules for this skill:
- Scan agents (axe-core, manual checks) return < 500 tokens each (full violations written to `.a11y/`)
- State file `.a11y/state-YYYYMMDD-HHMMSS.json` tracks which scan/fix phases are complete
- Resume from checkpoint if context resets ‚Äî skip completed scans and fixes
- Max 2 parallel scan agents (independent pages/components); fix agents run sequentially (they modify code)
- Orchestrator messages stay lean: "Phase 3: 8/15 violations fixed ‚Äî 4 auto-fixable remaining"

---

## AGENT ORCHESTRATION

This skill follows the **[Agent Orchestration Protocol](~/.claude/standards/AGENT_ORCHESTRATION.md)**.

The orchestrator coordinates agents but NEVER runs audits or fixes directly. All heavy work is delegated to focused agents that write results to disk.

### Model Selection for This Skill

| Agent Type | Model | Why |
|-----------|-------|-----|
| Component inventory | `haiku` | Listing components, counting forms/buttons ‚Äî no judgment |
| ARIA compliance analyzer | `sonnet` | Must understand ARIA roles, states, properties and their correct usage in context |
| Keyboard navigation analyzer | `sonnet` | Must understand focus management, tab order, keyboard trap prevention |
| Color contrast analyzer | `sonnet` | Must evaluate Tailwind color combinations against WCAG contrast ratios |
| Screen reader analyzer | `sonnet` | Must understand how content is announced, heading hierarchy, landmark structure |
| Form accessibility analyzer | `sonnet` | Must evaluate label associations, error messaging, validation feedback |
| Dynamic content analyzer | `sonnet` | Must assess live regions, loading states, modal focus management |
| Accessibility fixer | `sonnet` | Must write correct ARIA attributes, focus management, keyboard handlers |
| Report synthesizer | `sonnet` | Must compile WCAG compliance scores and prioritized violations |

### Agent Batching

- Inventory agents can run 2 in parallel (read-only)
- Analyzers can run 2 in parallel when covering different domains (e.g., ARIA + color contrast)
- Fix agents run SEQUENTIALLY (they modify code)
- Batch components into groups of 10-15 per analyzer agent

---

## MODES

```
/a11y                    - Full audit + auto-fix everything safe
/a11y audit              - Audit only, no fixes
/a11y fix A11Y-XXX       - Fix specific finding
/a11y report             - Generate compliance report
/a11y test               - Run accessibility tests
```

---

## CRITICAL RULES

1. **Fix automatically when safe** ‚Äî Most a11y fixes don't change functionality
2. **Never remove functionality** ‚Äî Add accessibility, don't break features
3. **Test with axe-core** ‚Äî Verify fixes actually work
4. **Mark tasks DONE, never delete** ‚Äî Preserve audit trail
5. **Write SITREP conclusion** ‚Äî Historical perspective
6. **Iterate until compliant** ‚Äî Re-scan after fixes

---

## OUTPUT STRUCTURE

```
.a11y/
‚îú‚îÄ‚îÄ a11y-YYYYMMDD-HHMMSS.md       # Main report with task list & conclusion
‚îú‚îÄ‚îÄ baseline.json                  # Initial violation count
‚îú‚îÄ‚îÄ history.json                   # All audits over time
‚îî‚îÄ‚îÄ findings.json                  # Machine-readable findings
```

---

## Report Persistence (CRITICAL ‚Äî Living Document)

The markdown report file is a **LIVING DOCUMENT**. It must be created at the START and updated continuously ‚Äî not generated at the end.

### Living Document Protocol

1. **Phase 0**: Create the full report skeleton at `.a11y/a11y-YYYYMMDD-HHMMSS.md` with `‚è≥ Pending` placeholders for all sections (scan results, fixes, validation)
2. **After each scan/fix**: Fill in completed sections with real results immediately. Write to disk.
3. **If context dies**: User can open the `.md` and see exactly what violations were found, what's been fixed, and what's pending

### Finding Statuses

| Status | Meaning |
|--------|---------|
| `FOUND` | Accessibility violation discovered during scan |
| `üîß FIXING` | Fix in progress |
| `‚úÖ FIXED` | Fix applied, axe-core re-scan confirmed |
| `‚è∏Ô∏è DEFERRED` | Needs design decision, component rewrite, or human judgment. Reason documented. |
| `üö´ BLOCKED` | Attempted fix, broke functionality or failed re-scan. Attempts documented. |

### Deferred Items Table

Every finding that can't be auto-fixed gets a row:

| # | ID | WCAG Criteria | Finding | Why Deferred | What Needs to Happen | Status |
|---|-----|--------------|---------|-------------|----------------------|--------|
| 1 | A11Y-XXX | [criterion] | [violation] | [needs design change / component rewrite / human decision] | [specific action] | ‚è≥ PENDING |

When working on deferred items, update Status in real-time on disk:
`‚è≥ PENDING` ‚Üí `üîß IN PROGRESS` ‚Üí `‚úÖ FIXED` or `üö´ BLOCKED`

### Rules

1. **Write report skeleton at Phase 0** ‚Äî file exists before any scans
2. **Update after each violation found and each fix applied** ‚Äî status changes in real-time
3. **Write to disk after every status change** ‚Äî if session dies, report shows where things stand
4. **SITREP section** ‚Äî for every DEFERRED or BLOCKED item, document what was tried and why it failed
5. **NEVER delete findings** ‚Äî only update their status

---

## WCAG 2.1 AA COVERAGE

### Principle 1: Perceivable

| Guideline | Criteria | Finding ID |
|-----------|----------|------------|
| **1.1.1 Non-text Content** | Images without alt text | A11Y-IMG-001 |
| | Decorative images without alt="" | A11Y-IMG-002 |
| | Complex images without long description | A11Y-IMG-003 |
| | Icon buttons without accessible name | A11Y-IMG-004 |
| | SVGs without title/aria-label | A11Y-IMG-005 |
| **1.2.1 Audio-only/Video-only** | Missing text alternative | A11Y-MEDIA-001 |
| **1.2.2 Captions** | Videos without captions | A11Y-MEDIA-002 |
| **1.2.3 Audio Description** | Missing audio description | A11Y-MEDIA-003 |
| **1.2.5 Audio Description (Prerecorded)** | No audio description track | A11Y-MEDIA-004 |
| **1.3.1 Info and Relationships** | Missing semantic structure | A11Y-STRUCT-001 |
| | Tables without headers | A11Y-STRUCT-002 |
| | Forms without labels | A11Y-STRUCT-003 |
| | Lists not using ul/ol/dl | A11Y-STRUCT-004 |
| | Headings out of order | A11Y-STRUCT-005 |
| **1.3.2 Meaningful Sequence** | Content order illogical | A11Y-STRUCT-006 |
| **1.3.3 Sensory Characteristics** | Instructions rely on shape/color only | A11Y-STRUCT-007 |
| **1.3.4 Orientation** | Locked to portrait/landscape | A11Y-STRUCT-008 |
| **1.3.5 Identify Input Purpose** | Missing autocomplete | A11Y-INPUT-001 |
| **1.4.1 Use of Color** | Color alone conveys info | A11Y-COLOR-001 |
| **1.4.2 Audio Control** | Auto-playing audio | A11Y-MEDIA-005 |
| **1.4.3 Contrast (Minimum)** | Text contrast < 4.5:1 | A11Y-COLOR-002 |
| | Large text contrast < 3:1 | A11Y-COLOR-003 |
| **1.4.4 Resize Text** | Text can't scale to 200% | A11Y-TEXT-001 |
| **1.4.5 Images of Text** | Text as images | A11Y-TEXT-002 |
| **1.4.10 Reflow** | Horizontal scroll at 320px | A11Y-LAYOUT-001 |
| **1.4.11 Non-text Contrast** | UI contrast < 3:1 | A11Y-COLOR-004 |
| **1.4.12 Text Spacing** | Can't adjust spacing | A11Y-TEXT-003 |
| **1.4.13 Content on Hover/Focus** | Tooltip not dismissable | A11Y-INTERACT-001 |

### Principle 2: Operable

| Guideline | Criteria | Finding ID |
|-----------|----------|------------|
| **2.1.1 Keyboard** | Not keyboard accessible | A11Y-KB-001 |
| | Custom controls not focusable | A11Y-KB-002 |
| | Drag-only interactions | A11Y-KB-003 |
| **2.1.2 No Keyboard Trap** | Focus trap without escape | A11Y-KB-004 |
| **2.1.4 Character Key Shortcuts** | Single-key shortcuts | A11Y-KB-005 |
| **2.2.1 Timing Adjustable** | No way to extend timeout | A11Y-TIME-001 |
| **2.2.2 Pause, Stop, Hide** | Moving content can't stop | A11Y-TIME-002 |
| **2.3.1 Three Flashes** | Flashing content | A11Y-FLASH-001 |
| **2.4.1 Bypass Blocks** | No skip link | A11Y-NAV-001 |
| **2.4.2 Page Titled** | Missing or generic title | A11Y-NAV-002 |
| **2.4.3 Focus Order** | Illogical tab order | A11Y-FOCUS-001 |
| **2.4.4 Link Purpose** | Unclear link text | A11Y-LINK-001 |
| | "Click here" / "Read more" | A11Y-LINK-002 |
| **2.4.5 Multiple Ways** | Only one way to find content | A11Y-NAV-003 |
| **2.4.6 Headings and Labels** | Missing/unclear headings | A11Y-STRUCT-009 |
| **2.4.7 Focus Visible** | No focus indicator | A11Y-FOCUS-002 |
| **2.4.11 Focus Not Obscured** | Focus hidden by sticky elements | A11Y-FOCUS-003 |
| **2.5.1 Pointer Gestures** | Complex gestures required | A11Y-POINTER-001 |
| **2.5.2 Pointer Cancellation** | No way to cancel | A11Y-POINTER-002 |
| **2.5.3 Label in Name** | Visible label doesn't match accessible name | A11Y-LABEL-001 |
| **2.5.4 Motion Actuation** | Motion-only activation | A11Y-MOTION-001 |

### Principle 3: Understandable

| Guideline | Criteria | Finding ID |
|-----------|----------|------------|
| **3.1.1 Language of Page** | Missing lang attribute | A11Y-LANG-001 |
| **3.1.2 Language of Parts** | No lang on foreign text | A11Y-LANG-002 |
| **3.2.1 On Focus** | Unexpected context change | A11Y-BEHAVIOR-001 |
| **3.2.2 On Input** | Unexpected form submission | A11Y-BEHAVIOR-002 |
| **3.2.3 Consistent Navigation** | Navigation changes order | A11Y-NAV-004 |
| **3.2.4 Consistent Identification** | Same function different labels | A11Y-LABEL-002 |
| **3.3.1 Error Identification** | Errors not announced | A11Y-ERROR-001 |
| **3.3.2 Labels or Instructions** | Missing input instructions | A11Y-FORM-001 |
| **3.3.3 Error Suggestion** | No error correction hint | A11Y-ERROR-002 |
| **3.3.4 Error Prevention** | No confirmation for important actions | A11Y-ERROR-003 |

### Principle 4: Robust

| Guideline | Criteria | Finding ID |
|-----------|----------|------------|
| **4.1.1 Parsing** | Invalid HTML | A11Y-HTML-001 |
| | Duplicate IDs | A11Y-HTML-002 |
| **4.1.2 Name, Role, Value** | Missing ARIA attributes | A11Y-ARIA-001 |
| | Invalid ARIA usage | A11Y-ARIA-002 |
| | Custom controls missing role | A11Y-ARIA-003 |
| **4.1.3 Status Messages** | No live regions for updates | A11Y-ARIA-004 |

---

## PHASE 1: AUTOMATED SCANNING

### 1.1 Run axe-core Analysis

```bash
# Install if needed
npm install --save-dev @axe-core/cli axe-core

# Run axe on pages
npx axe http://localhost:3000 --save .a11y/axe-results.json

# Or use Playwright with axe
npx playwright test --grep "accessibility"
```

### 1.2 Static Code Analysis

**Missing alt text:**
```bash
# Find images without alt
grep -rn "<img" --include="*.tsx" --include="*.jsx" . | grep -v "alt="

# Find Image components without alt
grep -rn "<Image" --include="*.tsx" . | grep -v "alt="
```

**Missing form labels:**
```bash
# Find inputs without associated labels
grep -rn "<input" --include="*.tsx" . | grep -v "aria-label\|aria-labelledby\|id="
```

**Missing lang attribute:**
```bash
# Check html element
grep -rn "<html" --include="*.tsx" . | grep -v 'lang='
```

**Focus indicators:**
```bash
# Find outline:none or outline:0 without replacement
grep -rn "outline.*none\|outline.*0" --include="*.css" --include="*.scss" .
```

### 1.3 Color Contrast Analysis

```javascript
// Check contrast ratios programmatically
function checkContrast(foreground, background) {
  const luminance = (color) => {
    const rgb = hexToRgb(color)
    const [r, g, b] = rgb.map(c => {
      c = c / 255
      return c <= 0.03928 ? c / 12.92 : Math.pow((c + 0.055) / 1.055, 2.4)
    })
    return 0.2126 * r + 0.7152 * g + 0.0722 * b
  }

  const l1 = luminance(foreground)
  const l2 = luminance(background)
  const ratio = (Math.max(l1, l2) + 0.05) / (Math.min(l1, l2) + 0.05)

  return {
    ratio,
    passesAA: ratio >= 4.5,        // Normal text
    passesAALarge: ratio >= 3,     // Large text (18pt or 14pt bold)
    passesAAA: ratio >= 7          // Enhanced
  }
}
```

### 1.4 Keyboard Navigation Testing

```javascript
// Test all interactive elements are focusable
const interactiveSelectors = [
  'a[href]',
  'button',
  'input',
  'select',
  'textarea',
  '[tabindex]:not([tabindex="-1"])',
  '[role="button"]',
  '[role="link"]',
  '[role="menuitem"]',
  '[role="tab"]'
]

// Find non-interactive elements with click handlers
// These need tabindex and keyboard handlers
grep -rn "onClick=" --include="*.tsx" . | grep "<div\|<span"
```

---

## PHASE 2: COMPREHENSIVE CHECKS

### 2.1 Images & Icons

| Check | Pattern | Finding ID |
|-------|---------|------------|
| **img without alt** | `<img>` missing alt attribute | A11Y-IMG-001 |
| **Decorative img with alt** | `<img alt="logo">` should be `alt=""` | A11Y-IMG-002 |
| **Icon button no label** | `<button><Icon /></button>` without aria-label | A11Y-IMG-004 |
| **SVG no accessible name** | `<svg>` without title or aria-label | A11Y-IMG-005 |
| **Background image with meaning** | CSS background for meaningful content | A11Y-IMG-006 |

**Detection:**
```javascript
// Icon-only buttons
<button><TrashIcon /></button>  // BAD
<button><SearchIcon /></button>  // BAD

// Links with only icons
<a href="/settings"><SettingsIcon /></a>  // BAD
```

### 2.2 Forms

| Check | Pattern | Finding ID |
|-------|---------|------------|
| **Input without label** | No associated `<label>` or aria-label | A11Y-FORM-001 |
| **Placeholder as label** | Using placeholder instead of label | A11Y-FORM-002 |
| **Required not announced** | Missing aria-required | A11Y-FORM-003 |
| **Error not associated** | Error message not linked to input | A11Y-FORM-004 |
| **Fieldset without legend** | Grouped inputs without legend | A11Y-FORM-005 |
| **Missing autocomplete** | Known fields without autocomplete | A11Y-INPUT-001 |

**Detection:**
```javascript
// Missing label
<input type="email" placeholder="Email" />  // BAD

// Error not associated
<input id="email" />
<span className="error">Invalid email</span>  // BAD - not linked
```

### 2.3 Semantic Structure

| Check | Pattern | Finding ID |
|-------|---------|------------|
| **Skipped heading level** | h1 ‚Üí h3 (skipped h2) | A11Y-STRUCT-005 |
| **Multiple h1** | More than one h1 per page | A11Y-STRUCT-010 |
| **No main landmark** | Missing `<main>` | A11Y-STRUCT-011 |
| **Click on div/span** | onClick without keyboard support | A11Y-STRUCT-012 |
| **List items outside list** | `<li>` without `<ul>`/`<ol>` | A11Y-STRUCT-004 |
| **Table for layout** | `<table>` for non-tabular content | A11Y-STRUCT-013 |
| **Empty buttons/links** | No accessible text content | A11Y-STRUCT-014 |

### 2.4 Keyboard & Focus

| Check | Pattern | Finding ID |
|-------|---------|------------|
| **Not focusable** | Interactive element can't receive focus | A11Y-KB-001 |
| **No visible focus** | Focus style removed | A11Y-FOCUS-002 |
| **Focus trap** | Can't escape modal/dropdown | A11Y-KB-004 |
| **Illogical tab order** | tabindex > 0 | A11Y-FOCUS-001 |
| **Missing skip link** | No way to skip to main content | A11Y-NAV-001 |
| **Focus moves unexpectedly** | Focus lost after action | A11Y-FOCUS-004 |
| **Mouse-only interaction** | Drag without keyboard alternative | A11Y-KB-003 |

### 2.5 ARIA

| Check | Pattern | Finding ID |
|-------|---------|------------|
| **Invalid role** | Non-existent ARIA role | A11Y-ARIA-002 |
| **Missing required ARIA** | Role without required attributes | A11Y-ARIA-001 |
| **Redundant ARIA** | `<button role="button">` | A11Y-ARIA-005 |
| **Abstract role** | Using abstract roles like `widget` | A11Y-ARIA-006 |
| **aria-hidden on focusable** | Hidden but still focusable | A11Y-ARIA-007 |
| **Missing live region** | Dynamic content without aria-live | A11Y-ARIA-004 |
| **Invalid aria-* value** | aria-expanded="yes" (should be "true") | A11Y-ARIA-008 |

### 2.6 Color & Contrast

| Check | Pattern | Finding ID |
|-------|---------|------------|
| **Text contrast** | Ratio < 4.5:1 for normal text | A11Y-COLOR-002 |
| **Large text contrast** | Ratio < 3:1 for 18pt+ text | A11Y-COLOR-003 |
| **UI component contrast** | Buttons, inputs < 3:1 | A11Y-COLOR-004 |
| **Color-only meaning** | Red for error without icon/text | A11Y-COLOR-001 |
| **Link not distinguishable** | Links same color as text | A11Y-COLOR-005 |

### 2.7 Content & Language

| Check | Pattern | Finding ID |
|-------|---------|------------|
| **Missing page title** | No `<title>` or generic title | A11Y-NAV-002 |
| **No lang attribute** | Missing html lang | A11Y-LANG-001 |
| **Unclear link text** | "Click here", "Read more" | A11Y-LINK-002 |
| **All caps text** | `text-transform: uppercase` on long text | A11Y-TEXT-004 |
| **Justified text** | `text-align: justify` | A11Y-TEXT-005 |

---

## PHASE 3: AUTO-FIX PATTERNS

### 3.1 Image Fixes

```typescript
// BEFORE: Missing alt
<img src="/hero.jpg" />

// AFTER: With descriptive alt
<img src="/hero.jpg" alt="Team collaborating around a whiteboard" />

// BEFORE: Decorative image with content alt
<img src="/divider.png" alt="decorative line" />

// AFTER: Empty alt for decorative
<img src="/divider.png" alt="" />

// BEFORE: Icon button without label
<button onClick={handleDelete}>
  <TrashIcon />
</button>

// AFTER: With aria-label
<button onClick={handleDelete} aria-label="Delete item">
  <TrashIcon aria-hidden="true" />
</button>

// BEFORE: SVG without accessible name
<svg viewBox="0 0 24 24">...</svg>

// AFTER: With title
<svg viewBox="0 0 24 24" role="img" aria-labelledby="svg-title">
  <title id="svg-title">Settings</title>
  ...
</svg>
```

### 3.2 Form Fixes

```typescript
// BEFORE: Input without label
<input type="email" placeholder="Enter your email" />

// AFTER: With visible label
<label htmlFor="email">Email address</label>
<input id="email" type="email" placeholder="Enter your email" />

// OR with aria-label if design requires no visible label
<input type="email" aria-label="Email address" placeholder="Enter your email" />

// BEFORE: Error not associated
<input id="email" />
{error && <span className="error">{error}</span>}

// AFTER: Error associated with aria-describedby
<input
  id="email"
  aria-invalid={!!error}
  aria-describedby={error ? "email-error" : undefined}
/>
{error && <span id="email-error" className="error" role="alert">{error}</span>}

// BEFORE: Missing autocomplete
<input type="email" name="email" />

// AFTER: With autocomplete
<input type="email" name="email" autoComplete="email" />
```

### 3.3 Structure Fixes

```typescript
// BEFORE: Click on div
<div onClick={handleClick} className="card">
  Content
</div>

// AFTER: Interactive with keyboard support
<div
  onClick={handleClick}
  onKeyDown={(e) => e.key === 'Enter' && handleClick()}
  role="button"
  tabIndex={0}
  className="card"
>
  Content
</div>

// OR better: use a button
<button onClick={handleClick} className="card">
  Content
</button>

// BEFORE: Missing skip link
<header>...</header>
<main>...</main>

// AFTER: With skip link
<a href="#main-content" className="skip-link">
  Skip to main content
</a>
<header>...</header>
<main id="main-content" tabIndex={-1}>...</main>

// CSS for skip link
.skip-link {
  position: absolute;
  left: -9999px;
  z-index: 999;
  padding: 1em;
  background: white;
  color: black;
}
.skip-link:focus {
  left: 50%;
  transform: translateX(-50%);
}
```

### 3.4 Focus Fixes

```typescript
// BEFORE: Focus removed
button:focus {
  outline: none;
}

// AFTER: Custom focus indicator
button:focus {
  outline: none;
}
button:focus-visible {
  outline: 2px solid #4f46e5;
  outline-offset: 2px;
}

// BEFORE: Focus trap without escape
function Modal({ isOpen, children }) {
  return isOpen ? <div className="modal">{children}</div> : null
}

// AFTER: Focus trap with escape and focus management
function Modal({ isOpen, onClose, children }) {
  const modalRef = useRef(null)

  useEffect(() => {
    if (isOpen) {
      // Save previous focus
      const previousFocus = document.activeElement

      // Focus first focusable element
      modalRef.current?.querySelector('button')?.focus()

      // Return focus on close
      return () => previousFocus?.focus()
    }
  }, [isOpen])

  useEffect(() => {
    const handleEscape = (e) => {
      if (e.key === 'Escape') onClose()
    }
    if (isOpen) document.addEventListener('keydown', handleEscape)
    return () => document.removeEventListener('keydown', handleEscape)
  }, [isOpen, onClose])

  if (!isOpen) return null

  return (
    <div
      ref={modalRef}
      role="dialog"
      aria-modal="true"
      aria-labelledby="modal-title"
    >
      {children}
    </div>
  )
}
```

### 3.5 ARIA Fixes

```typescript
// BEFORE: Missing live region for dynamic content
function Notification({ message }) {
  return <div className="notification">{message}</div>
}

// AFTER: With live region
function Notification({ message }) {
  return (
    <div role="status" aria-live="polite" className="notification">
      {message}
    </div>
  )
}

// BEFORE: Expandable without aria-expanded
<button onClick={() => setOpen(!open)}>
  Menu
</button>
{open && <div>Menu items</div>}

// AFTER: With aria-expanded
<button
  onClick={() => setOpen(!open)}
  aria-expanded={open}
  aria-controls="menu-items"
>
  Menu
</button>
{open && <div id="menu-items">Menu items</div>}

// BEFORE: Tab list without ARIA
<div className="tabs">
  <button onClick={() => setTab(1)}>Tab 1</button>
  <button onClick={() => setTab(2)}>Tab 2</button>
</div>

// AFTER: With proper ARIA
<div role="tablist" aria-label="Content tabs">
  <button
    role="tab"
    id="tab-1"
    aria-selected={activeTab === 1}
    aria-controls="panel-1"
    onClick={() => setTab(1)}
  >
    Tab 1
  </button>
  <button
    role="tab"
    id="tab-2"
    aria-selected={activeTab === 2}
    aria-controls="panel-2"
    onClick={() => setTab(2)}
  >
    Tab 2
  </button>
</div>
<div
  role="tabpanel"
  id="panel-1"
  aria-labelledby="tab-1"
  hidden={activeTab !== 1}
>
  Panel 1 content
</div>
```

### 3.6 Color/Contrast Fixes

```css
/* BEFORE: Low contrast */
.text-muted {
  color: #999999; /* 2.8:1 on white - fails */
}

/* AFTER: Sufficient contrast */
.text-muted {
  color: #767676; /* 4.54:1 on white - passes AA */
}

/* BEFORE: Color only for error */
.error {
  color: red;
}

/* AFTER: Color + icon */
.error {
  color: #dc2626;
}
.error::before {
  content: "‚ö† ";
}
```

### 3.7 Language Fixes

```typescript
// BEFORE: Missing lang
<html>

// AFTER: With lang
<html lang="en">

// BEFORE: Unclear link
<a href="/terms">Click here</a>

// AFTER: Descriptive link
<a href="/terms">Read our terms of service</a>
```

---

## PHASE 4: VALIDATION

### 4.1 Re-run axe-core

```bash
npx axe http://localhost:3000 --save .a11y/axe-results-after.json

# Compare before/after
diff .a11y/axe-results.json .a11y/axe-results-after.json
```

### 4.2 Manual Checks

| Check | How to Test |
|-------|-------------|
| **Keyboard navigation** | Tab through entire page, verify all interactive elements reachable |
| **Screen reader** | Test with VoiceOver (Mac) or NVDA (Windows) |
| **Zoom** | Zoom to 200%, verify no horizontal scroll |
| **Focus visibility** | Tab through, verify focus always visible |
| **Color contrast** | Use browser devtools accessibility panel |

### 4.3 Build Verification

```bash
npm run build
npm test
```

---

## PHASE 5: REPORT & SITREP

### 5.1 Main Report File

```markdown
# Accessibility Audit: [PROJECT_NAME]

**Created:** [YYYY-MM-DD HH:MM:SS]
**Status:** üü¢ COMPLETE
**Standard:** WCAG 2.1 AA

---

## Executive Summary

### Compliance Score

| Metric | Before | After | Improvement |
|--------|--------|-------|-------------|
| Critical | 8 | 0 | -8 (100% fixed) |
| Serious | 15 | 0 | -15 (100% fixed) |
| Moderate | 12 | 0 | -12 (100% fixed) |
| Minor | 5 | 2 | -3 (60% fixed) |
| **Total** | **40** | **2** | **95% fixed** |

### WCAG Coverage

| Principle | Criteria Checked | Issues | Fixed |
|-----------|------------------|--------|-------|
| Perceivable | 15 | 18 | 18 ‚úÖ |
| Operable | 12 | 12 | 12 ‚úÖ |
| Understandable | 8 | 6 | 6 ‚úÖ |
| Robust | 5 | 4 | 2 ‚úÖ |

---

## Task List

### Critical (Must Fix)

- [x] **A11Y-IMG-004**: 12 icon buttons without accessible names
  - Files: `components/Button.tsx`, `components/Toolbar.tsx`
  - Fix: Added aria-label to all icon buttons
  - Fixed at: 14:32:15
  - Status: ‚úÖ DONE

- [x] **A11Y-FORM-001**: 8 inputs without labels
  - Files: `components/LoginForm.tsx`, `components/SearchBar.tsx`
  - Fix: Added associated labels
  - Fixed at: 14:35:22
  - Status: ‚úÖ DONE

- [x] **A11Y-KB-001**: 5 clickable divs not keyboard accessible
  - Files: `components/Card.tsx`, `components/MenuItem.tsx`
  - Fix: Added role="button", tabIndex, onKeyDown
  - Fixed at: 14:38:45
  - Status: ‚úÖ DONE

### Serious (Should Fix)

- [x] **A11Y-COLOR-002**: 15 text elements with low contrast
  - Files: Multiple CSS files
  - Fix: Updated colors to meet 4.5:1 ratio
  - Fixed at: 14:42:10
  - Status: ‚úÖ DONE

- [x] **A11Y-FOCUS-002**: Focus styles removed globally
  - File: `globals.css`
  - Fix: Added :focus-visible styles
  - Fixed at: 14:45:30
  - Status: ‚úÖ DONE

- [x] **A11Y-NAV-001**: No skip link
  - File: `app/layout.tsx`
  - Fix: Added skip to main content link
  - Fixed at: 14:48:00
  - Status: ‚úÖ DONE

### Moderate

- [x] **A11Y-STRUCT-005**: Heading levels skipped
  - Files: Multiple page components
  - Fix: Corrected heading hierarchy
  - Fixed at: 14:52:00
  - Status: ‚úÖ DONE

- [x] **A11Y-ARIA-004**: Dynamic content without live regions
  - Files: `components/Notification.tsx`, `components/Toast.tsx`
  - Fix: Added aria-live="polite"
  - Fixed at: 14:55:00
  - Status: ‚úÖ DONE

### Minor (Remaining)

- [ ] **A11Y-TEXT-004**: Uppercase text on long paragraphs
  - Status: ‚ö†Ô∏è FLAGGED
  - Reason: Design decision, needs stakeholder input

- [ ] **A11Y-LINK-002**: 2 "Read more" links remaining
  - Status: ‚ö†Ô∏è FLAGGED
  - Reason: Content team to provide better text

---

## Components Fixed

| Component | Issues | Fixes Applied |
|-----------|--------|---------------|
| `Button.tsx` | 4 | aria-label, focus styles |
| `Card.tsx` | 3 | role, tabIndex, onKeyDown |
| `LoginForm.tsx` | 5 | labels, error associations |
| `Modal.tsx` | 4 | focus trap, escape key, aria-modal |
| `Notification.tsx` | 2 | aria-live, role |
| `Tabs.tsx` | 6 | Full ARIA tab pattern |

**Total:** 18 components modified

---

## CSS Changes

| File | Change |
|------|--------|
| `globals.css` | Added :focus-visible styles |
| `colors.css` | Updated 15 color variables for contrast |
| `components.css` | Added skip link styles |

---

## Generated Files

| File | Purpose |
|------|---------|
| `components/SkipLink.tsx` | Skip to main content component |
| `hooks/useFocusTrap.ts` | Reusable focus trap hook |
| `utils/a11y.ts` | Accessibility helper functions |

---

## Validation Results

| Check | Status |
|-------|--------|
| axe-core scan | ‚úÖ 0 critical/serious violations |
| Keyboard navigation | ‚úÖ All interactive elements reachable |
| Focus visibility | ‚úÖ Focus always visible |
| Screen reader test | ‚úÖ All content announced correctly |
| 200% zoom | ‚úÖ No horizontal scroll |

---

## SITREP (Conclusion)

### Mission Status: üü¢ COMPLETE

**Duration:** 28 minutes 15 seconds

### What Was Accomplished

1. **Images Made Accessible (14 fixes)**
   - Added aria-labels to 12 icon buttons
   - Fixed 2 images missing alt text
   - All decorative images now have empty alt

2. **Forms Made Accessible (13 fixes)**
   - Associated labels with 8 inputs
   - Added error associations to 3 forms
   - Added autocomplete to 2 fields

3. **Keyboard Navigation Fixed (8 fixes)**
   - Made 5 clickable divs keyboard accessible
   - Added focus trap to 2 modals
   - Added Escape key handling to dropdowns

4. **Color Contrast Fixed (15 fixes)**
   - Updated 15 text colors to meet 4.5:1 ratio
   - All UI components now meet 3:1 ratio
   - Added icons to color-coded status indicators

5. **ARIA Enhanced (6 fixes)**
   - Added live regions for notifications
   - Implemented proper tab pattern
   - Fixed invalid ARIA attributes

6. **Navigation Improved (4 fixes)**
   - Added skip to main content link
   - Fixed heading hierarchy
   - Added descriptive page titles

### Compliance Score

| Before | After | Standard |
|--------|-------|----------|
| 40 violations | 2 violations | WCAG 2.1 AA |
| 0% compliant | 95% compliant | Target: 100% |

### Remaining Items

2 minor issues flagged for content/design team:
- Uppercase text styling (design decision)
- Generic "Read more" links (content needed)

### Recommendations

1. Run `/a11y` before each release
2. Add axe-core to CI pipeline
3. Train team on accessibility best practices
4. Test with actual screen reader users

### Historical Context

This is accessibility audit #2 for this project:
- Audit #1 (2026-01-15): Score 60% ‚Üí 85%
- **Audit #2 (today):** Score 85% ‚Üí 95%

**Trend:** Accessibility improving consistently

---

*Report generated by /a11y*
*WCAG 2.1 AA compliance: 95%*
```

### 5.2 Update History

```json
{
  "audits": [
    {
      "id": 2,
      "timestamp": "2026-02-05T15:00:00Z",
      "duration_seconds": 1695,
      "violations": {
        "critical": { "before": 8, "after": 0 },
        "serious": { "before": 15, "after": 0 },
        "moderate": { "before": 12, "after": 0 },
        "minor": { "before": 5, "after": 2 }
      },
      "compliance_before": 85,
      "compliance_after": 95,
      "components_fixed": 18,
      "report_file": ".a11y/a11y-20260205-150000.md"
    }
  ]
}
```

---

## REMEMBER

- **Fix everything safe** ‚Äî Most a11y fixes don't change functionality
- **Test with real tools** ‚Äî axe-core, keyboard, screen reader
- **Mark DONE, never delete** ‚Äî Audit trail matters
- **SITREP conclusion** ‚Äî Historical perspective
- **Iterate until compliant** ‚Äî Target 100% WCAG 2.1 AA
- **Accessibility benefits everyone** ‚Äî Not just users with disabilities

---

<!-- 
  Claude Code Skill by Steel Motion LLC
  https://steelmotionllc.com/portfolio/software/claude-code-skills
  Licensed under MIT - see LICENSE
-->
